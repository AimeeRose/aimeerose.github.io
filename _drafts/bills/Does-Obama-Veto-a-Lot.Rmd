---
title: "Does Obama Veto Alot?"
output: html_document
---

It was stated recently on PBS Obama has vetoed only 2 bills while in office, the least number of vetoes of any President in history. I pondered: Could it be that 2 vetoes is actually an average or great number of vetoes as a relative measure? If, for example, Congress had been ineffective in introducing and passing bills and only 2 had reached Obama's desk, then he would be quite the Contrary Connor.

Let's look at the numbers.

```{r, echo = FALSE}
setwd('~/Projects/aimeerose.github.io/_drafts/bills')

# install.packages('RMySQL', type = 'source')
library(RMySQL)
library(ggplot2)
library(dplyr)
library(stringr)
library(reshape2)

conn <- dbConnect(MySQL(), user = 'root', password = '',
                  dbname = 'govtrack', host = 'localhost')

bills <- dbReadTable(conn, 'bills')

bills$congress <- factor(bills$congress)
bills$bill_type <- factor(bills$bill_type)

ggplot(data = bills, aes(x = congress)) + 
  geom_histogram(colour = 'darkolivegreen', fill = 'darkolivegreen3') +
  ggtitle('Bills in Congress') +
  scale_x_discrete(breaks = seq(0,114,4))
```

Whoa! What happened between the 92nd and 93rd congress? Nothing, or at least nothing that explains this bar graph. The jump in numbers is just a characteristic of the data sources. Govtrack.us data for bills is consistently provided from 1973 through today by THOMAS.gov, from 1951 through 1971 from GPO.gov/FDSys, and for 1799-1873 from the Library of Congressâ€™s American Memory Century of Lawmaking collection via the am_mem_law project ([source](https://www.govtrack.us/about)). This also explains the missing congress sessions 43 through 81. 

For the remainder of this post, I will be restricting analysis to those before the 93rd Congress, and those after.

```{r, echo = FALSE}
modern_bills <- bills[bills$congress %in% c(93:113), ]

ggplot(data = modern_bills, aes(x = congress)) + 
  geom_histogram(colour = 'darkolivegreen', fill = 'darkolivegreen3') +
  ggtitle('Bills in Congress since the 93rd session')
```


## Have you met my friend bill?

There a lot of bills which have never moved past being introduced to Congress. As categorized by the govtrack database, there have been over 300,000 bills introduced into congress which is really a low ball estimate due to the data sources, and 29 current states for all the bills in this corpus. The differences are mostly in ways a bill can die in Congress. For a complete listing of these statii, see **Appendix A: 29 Flavors of Legislative State**

In order to make these states digestable to the lay person, the states have been collapsed into:

* **Introduced:** The bill was introduced.
* **Referred:** The bill was referred to committee but never reported.
* **Reported:** The bill was addressed by its committee and reported to Congress.
* **Enacted:** The bill was enacted. This includes bills enacted by the ten-day rule and bills enacted by "unknown".
* **Enacted veto override:** The bill was enacted by Congressional override of a Presidential veto.
* **Passed bill:** The bill passed Congress but was never enacted before the end of the session.
* **Congressional stalemate:** The bill was never passed because of one of the following reasons: it did not receive mutual approval in the House and Senate; non-identical forms were passed; it was killed by a suspension vote; it failed vote for cloture or it was killed while resolving differences.
* **Vetoed:** The bill was vetoed successfully. This includes pocket vetoes.
* **Resolution passed:** Passed simple and concurrent resolutions.


```{r, echo = FALSE}
enacted <- list(
  'enacted_signed',
  'enacted_unknown',
  'enacted_tendayrule')

congressional_stalemates <- list(
  'pass_over_senate',
  'pass_over_house',
  'pass_back_house',
  'pass_back_senate',
  'fail_originating_house',
  'fail_originating_senate',
  'conference_passed_house',
  'fail_second_house',
  'fail_second_senate',
  'conference_passed_senate',
  'prov_kill_suspensionfailed',
  'prov_kill_cloturefailed')

vetoed <- list(
  'prov_kill_veto',
  'vetoed_pocket',
  'override_pass_over_house',
  'vetoed_override_fail_second_senate',
  'vetoed_override_fail_originating_house',
  'vetoed_override_fail_originating_senate',
  'vetoed_override_fail_second_house')

resolution_passed <- list(
  'passed_concurrentres',
  'passed_simpleres')

collapsed_states <- function(bill_state){
  returned_state <- if (bill_state %in% congressional_stalemates) {
    return('congressional_stalemates')
  } else if (bill_state %in% enacted) {
    return('enacted')
  } else if (bill_state %in% vetoed) {
    return('vetoed')
  } else if (bill_state %in% resolution_passed) {
    return('resolution_passed')
  } else {
    return(bill_state)
  }
  
  return(returned_state)
}

modern_bills$current_status.f <- unlist(lapply(modern_bills[,c('current_status')], collapsed_states))

grouped_bills <- modern_bills %>%
  group_by(current_status.f) %>%
  summarise(total = n()) %>%
  mutate(freq = round(total / sum(total), 4)) %>%
  arrange(total)

print(grouped_bills)

grouped_bills_subset <- subset(grouped_bills, total > 100)

ggplot(data = grouped_bills, aes(x = 1, y = total, fill = current_status.f)) +
  geom_bar(stat = 'identity', color = 'black') +
  coord_polar(theta='y', start = 45) +
  guides(fill = guide_legend(override.aes = list(colour = NA), title = 'Current Status')) +
  theme(axis.ticks = element_blank(), axis.title = element_blank(), axis.text.y = element_blank()) +
  theme(axis.text.x = element_blank()) +
  ggtitle('Current Bill Statuses since 93rd Congress')
```

Sometimes when you go looking for something, you find something else you entirely weren't looking for: **69% of all bills in US history are currently in the "referred" state meaning they are still waiting to be addressed by their committee. An even greater proportion (81%) are in this state if only counting back to 1973.**

```{r, echo = FALSE}
ggplot(data = modern_bills, aes(x = congress, fill = current_status.f)) + 
  geom_bar(colour = 'darkolivegreen', fill = 'darkolivegreen3') +
  ggtitle('Current Bill Status')
```


This provides (very) minor support for the claim Congress is becoming more and more ineffectual. There is greater support for this claim when looking solely at the number of bills enacted.

```{r, echo = FALSE}
ggplot(data = subset(modern_bills, current_status.f %in% list('enacted', 'enacted_veto_override')), aes(x = congress)) + 
  geom_histogram(colour = 'darkolivegreen', fill = 'darkolivegreen3') +
  scale_y_continuous(breaks = seq(0, 800, 100)) +
  ggtitle('Number of bills enacted by Congress')
```


```{r, echo = FALSE}
ggplot(data = subset(modern_bills, current_status.f == 'introduced'), aes(x = congress)) + 
  geom_histogram(colour = 'darkolivegreen', fill = 'darkolivegreen3') +
  ggtitle('Number of bills introduced to Congress')
```

Whoa! What was going on in the 97 through 100th Congressional sessions? Ronald Reagan was president during those sessions but more likely it was some other characteristic of those congressional sessions. Note: this is the number of bills introduced during that period which are *still* in the introduced state, not to be confused with the *total* number of bills introduced during that period.


```{r, echo = FALSE}
extract_sortname <- function(sponsor_blob) {
 extracted <- str_extract(sponsor_blob, "sortname\\\"(.+)\\\",")
 return(sub("\\\",", "", sub("sortname\\\"=>\\\"", "", extracted)))
}

modern_bills$sponsor.sort_name <- unlist(lapply(modern_bills[,c('sponsor')], extract_sortname))

modern_bills$sponsor.sort_name <- factor(modern_bills$sponsor.sort_name)

reagan_bills <- modern_bills[modern_bills$congress %in% c(97:100), ]
reagan_bills_introduced <- subset(reagan_bills, current_status == 'introduced')

# 170 levels
grouped_reagan_bills <- reagan_bills_introduced %>%
  group_by(sponsor.sort_name) %>%
  summarise(total = n()) %>%
  mutate(freq = round(total / sum(total), 4)) %>%
  arrange(-total)

before_reagan_bills <- modern_bills[modern_bills$congress %in% c(93:96), ]
before_reagan_bills_introduced <- subset(before_reagan_bills, current_status == 'introduced')

grouped_before_reagan_bills <- before_reagan_bills_introduced %>%
  group_by(sponsor.sort_name) %>%
  summarise(total = n()) %>%
  mutate(freq = round(total / sum(total), 4)) %>%
  arrange(-total)

after_reagan_bills <- modern_bills[modern_bills$congress %in% c(101:104), ]
after_reagan_bills_introduced <- subset(after_reagan_bills, current_status == 'introduced')

grouped_after_reagan_bills <- after_reagan_bills_introduced %>%
  group_by(sponsor.sort_name) %>%
  summarise(total = n()) %>%
  mutate(freq = round(total / sum(total), 4)) %>%
  arrange(-total)
```

## Comparing 4 sessions before, after and during the Reagan presidency

```{r, echo = FALSE}
# Before
grouped_before_reagan_bills <- before_reagan_bills_introduced %>%
  group_by(bill_type) %>%
  summarise(total = n()) %>%
  mutate(freq = round(total / sum(total), 4)) %>%
  arrange(-total)

pie_grouped_before_reagan <- ggplot(data = grouped_before_reagan_bills, aes(x = 1, y = total, fill = bill_type)) +
  geom_bar(stat = 'identity', color = 'black') +
  ggtitle('Introduced before Reagan') +
  coord_polar(theta='y', start = 45) +
  guides(fill = guide_legend(override.aes = list(colour = NA), title = 'Bill Types')) +
  theme(axis.ticks = element_blank(), axis.title = element_blank(), axis.text.y = element_blank()) +
  theme(axis.text.x = element_blank())

# After
grouped_after_reagan_bills <- after_reagan_bills_introduced %>%
  group_by(bill_type) %>%
  summarise(total = n()) %>%
  mutate(freq = round(total / sum(total), 4)) %>%
  arrange(-total)

pie_grouped_after_reagan <- ggplot(data = grouped_after_reagan_bills, aes(x = 1, y = total, fill = bill_type)) +
  geom_bar(stat = 'identity', color = 'black') +
  ggtitle('Introduced after Reagan') +
  coord_polar(theta='y', start = 45) +
  guides(fill = guide_legend(override.aes = list(colour = NA), title = 'Bill Types')) +
  theme(axis.ticks = element_blank(), axis.title = element_blank(), axis.text.y = element_blank()) +
  theme(axis.text.x = element_blank())

# During
grouped_reagan_bills <- reagan_bills_introduced %>%
  group_by(bill_type) %>%
  summarise(total = n()) %>%
  mutate(freq = round(total / sum(total), 4)) %>%
  arrange(-total)

pie_grouped_during_reagan <- ggplot(data = grouped_reagan_bills, aes(x = 1, y = total, fill = bill_type)) +
  geom_bar(stat = 'identity', color = 'black') +
  ggtitle('Introduced during Reagan') +
  coord_polar(theta='y', start = 45) +
  guides(fill = guide_legend(override.aes = list(colour = NA), title = 'Bill Types')) +
  theme(axis.ticks = element_blank(), axis.title = element_blank(), axis.text.y = element_blank()) +
  theme(axis.text.x = element_blank())

pie_grouped_before_reagan
pie_grouped_during_reagan
pie_grouped_after_reagan
```

**Nearly 10 times more house resolutions from the Reagan years still exist in the introduced state as before and after the Reagan years.**

House representatives were either *very* involved or *very* ineffective (or both) during the Reagan years. 996 house resolutions from the congressional sessions when Reagan was in office are still in the "introduced" state, whereas before and after Reagan sessions only 103 and 26 house resolutions still exist as "introduced", respectively. 

This imbalance is mirrored when looking at bill sponsors: The top 10 sponsors of bills during the Reagan years were all from the house and have between 40 and 125 outstanding bills or resolutions introduced. The top ten before and after the Reagan sessions all have 17 or less outstanding.

### Back to the original question: Does Obama veto a lot?

Obama was president during the 111th, 112th and 113th Congressional sessions.

```{r, echo = FALSE}
modern_bills_grouped <- modern_bills %>%
  group_by(congress, current_status.f) %>%
  summarise(total_of_status = n()) %>%
  mutate(total_bills = sum(total_of_status))

casted <- dcast(modern_bills_grouped, value.var = 'total_of_status', total_bills + congress ~ current_status.f)
casted$proportion_vetoed <- casted$vetoed / casted$total_bills

ggplot(data = casted, aes(x = congress, y = proportion_vetoed)) + 
  geom_bar(stat = 'identity', colour = 'darkolivegreen', fill = 'darkolivegreen3') +
  ylab('Proportion Vetoed') +
  ggtitle('Proportion of bills vetoed')
```

**It is true Obama has issued, both in total numbers and relative to total bills, the least number of vetoes when compared with other Presidents.**

**There is also some evidence to suggest the number of bills enacted, and thus bills available to veto, is declining over time.**

```{r, echo = FALSE}
ggplot(data = subset(modern_bills, current_status.f %in% list('enacted', 'enacted_veto_override')), aes(x = congress)) + 
  geom_histogram(colour = 'darkolivegreen', fill = 'darkolivegreen3') +
  scale_y_continuous(breaks = seq(0, 800, 100)) +
  ylab('Number of bills enacted') +
  ggtitle('Number of bills enacted by Congress')
```


### Appendix A: 29 Flavors of Legislative State

#### Identity
* **referred:** The bill was introduced and referred to a committee, but never reported.
* **reported:** The bill was adressed in a hearing by its committee, but was never enacted by Congress.
* **introduced:** The bill was introduced.
* **enacted_veto_override:** The bill was enacted after a congressional override of the Presidential veto.
* **passed_bill:** The bill passed Congress but was never enacted before the end of the session.

#### Congressional Stalemate
* **pass_over_senate:** The bill passed the Senate but not the House.
* **pass_over_house:** The bill passed the House but not Senate.
* **pass_back_house:** The bill passed by both chambers but was passed in non-identical forms and the differences were never resolved.
* **pass_back_senate:** The bill passed by both chambers but was passed in non-identical forms and the differences were never resolved.
* **fail_originating_house:** The bill failed in the House.
* **fail_originating_senate:** The bill failed in the Senate.
* **conference_passed_house:** The bill was introduced in a previous session of Congress. It was passed by both chambers but it passed in non-identical forms.
* **fail_second_house:** The bill passed in senate, failed in house.
* **failed_second_senate:** The bill was passed in the House but failed in the Sentate.
* **conference_passed_senate:** The bill was introduced in a previous session of Congress. It was passed in non-identical form and only one chamber approved a conference report to resolve the differences.
* **prov_kill_suspensionfailed:** A catch-all for random ways for a bill to die in Congress. The bill was introduced but was killed due to a failed vote for cloture (placing a time limit on the debate), under a fast-track vote called 'suspension' (meant to quickly pass non-controversial bills), or while resolving differences.
* **prov_kill_cloturefailed:** Same as description above for 'prov_kill_suspensionfailed'.

#### Vetoed
* **prov_kill_veto:** The bill was vetoed by the President and Congress did not attempt an override.
* **vetoed_pocket:** The bill was pocket vetoed. A bill is pocket vetoed when the President does not sign the bill and Congress adjourns before the ten-day period expires.
* **override_pass_over_house:** The bill was vetoed by the President and Congress did not finish an override before the end of the Congressional session.
* **vetoed_override_fail_second_senate:** The bill was vetoed. The Senate attempted to override the veto but failed.
* **vetoed_override_fail_originating_house:** The bill was vetoed. The House attempted to override the veto but failed.
* **vetoed_override_fail_originating_senate:** The bill was vetoed by the President and Senate did not finish an override before the end of the Congressional session.
* **vetoed_override_fail_second_house:** The bill was vetoed by the President and the House did not finish an override before the end of the Congressional session.

#### Enacted
* **enacted_signed:** The bill was enacted after being signed.
* **enacted_unknown:** The bill was enacted.
* **enacted_tendayrule:** The bill became enacted after ten days elapsed after being presented to the President.

#### Passed Resolutions
* **passed_concurrentres:** The concurrent resolution was agreed to by both Chambers, which is the end of the legislative process for concurrent resolutions.
* **passed_simpleres:** The bill is a simple resolution and was passed^.

***simple resolution:*** Designated "S. Res.," simple resolutions are used to express nonbinding positions of the Senate or to deal with the Senate's internal affairs, such as the creation of a special committee. They do not require action by the House of Representatives. ([source](https://www.senate.gov/reference/glossary_term/simple_resolution.htm))


### Resources

http://mathematicalcoffee.blogspot.com/2014/06/ggpie-pie-graphs-in-ggplot2.html